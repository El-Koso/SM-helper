# Документация к коду приложения для ввода и обработки данных

Этот код представляет собой приложение на Python с графическим интерфейсом (GUI) на основе Tkinter, предназначенное для генерации XML- файла с данными о сотрудниках организации, прошедших обучение и аттестацию по определенным программам подготовки в области охраны труда. Приложение также позволяет сохранять информацию о протоколах.

## I. Структура приложения:

Приложение состоит из нескольких модулей (хотя в представленном коде они объединены в одном файле):

* **GUI (графический интерфейс):** Создает и управляет всеми элементами интерфейса: полями ввода, кнопками, списком учебных программ и таблицей протоколов.
* **Валидация данных:** Проверяет корректность введенных данных (формат СНИЛС, дата).
* **Взаимодействие с базой данных:** Отвечает за создание базы данных, добавление, удаление и обновление записей, а также за выборку данных для отображения и генерации XML.
* **Генерация XML:** Формирует XML-файл с данными из базы данных, согласно заданной структуре.


## II. Функциональность:

1. **Ввод данных:** Пользовательский интерфейс позволяет вводить информацию о сотруднике: фамилия, имя, отчество, СНИЛС, профессия, данные об организации, работодателе, выбранные учебные программы, статус прохождения проверки знаний (сдал/не сдал), номер и дата протокола. Предусмотрена валидация введенных данных на корректность формата.

2. **Сохранение данных в базе данных:** Введенные данные сохраняются в таблицу `users` базы данных SQLite (`data.db`). Если база данных не существует, она создается автоматически. Дата и время добавления записи также записываются в базу.

3. **Очистка полей:** Предусмотрены кнопки для очистки всех полей ввода или только части полей (ФИО, СНИЛС).

4. **Генерация XML:** Приложение позволяет генерировать XML-файлы с данными из базы данных. Можно сгенерировать XML-файл для всех записей или только для записей, соответствующих заданному номеру протокола. Формат XML соответствует определенной структуре.

5. **Просмотр и управление данными 

## III. Основные функции:

* `validate_snils(snils)`: Проверяет корректность формата СНИЛС.
* `validate_date(date_str)`: Проверяет корректность формата даты.
* `submit_data(conn)`: Сохраняет данные в базу данных после проверки.
* `clear_all_entries()`: Очищает все поля ввода.
* `clear_partial_entries()`: Очищает поля "Фамилия", "Имя", "Отчество", "СНИЛС".
* `create_xml(conn, target_protocol_number)`: Создает XML-файл.
* `create_database(conn)`: Создает базу данных и таблицу `users`, если они не существуют.
* `generate_xml_for_selected(conn, tree)`: Создает XML-файл для выбранного протокола.
* `delete_selected_entry(conn, tree)`: Удаляет выбранную запись.
* `show_details(conn, tree, selected_item)`: Показывает и позволяет изменить запись.
* `save_changes(item_id)`: Сохраняет изменения в записи.


## IV. Схема базы данных:

Таблица `users`:

| Название поля          | Тип данных | Описание                                       |
|------------------------|------------|------------------------------------------------|
| id                     | INTEGER    | Уникальный идентификатор записи                |
| surname                | TEXT       | Фамилия сотрудника                             |
| name                   | TEXT       | Имя сотрудника                                 |
| patronymic             | TEXT       | Отчество сотрудника                            |
| snils                  | TEXT       | СНИЛС сотрудника                               |
| isForeignSnils         | INTEGER    | 1 - иностранный СНИЛС, 0 - нет                 |
| foreignSnils           | TEXT       | Иностранный СНИЛС                              |
| citizenship            | TEXT       | Гражданство                                    |
| position               | TEXT       | Должность сотрудника                           |
| org_inn                | TEXT       | ИНН организации                                |
| org_title              | TEXT       | Название организации                           |
| employer_org_inn       | TEXT       | ИНН работодателя                               |
| employer_org_title     | TEXT       | Название работодателя                          |
| learn_program_id       | INTEGER    | ID учебной программы                           |
| is_passed              | INTEGER    | 1 - проверка пройдена, 0 - нет                 |
| protocol_number        | TEXT       | Номер протокола                                |
| exam_date              | TEXT       | Дата проверки знаний                           |
| entry_date             | TEXT       | Дата и время добавления записи в базу данных   |




	

